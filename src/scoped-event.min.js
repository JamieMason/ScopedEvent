var scopedEvent=function(){function n(n,r){return n==="*"||r.search(new RegExp("^"+n.replace(e,"").replace(t,"\\$1")+"(\\.|:|$)"))!==-1}function r(e,t){return e[t]!==void 0}function i(e,t){e=e||[];var n,r=e.length,i;for(n=0;n<r;n++){i=t(e[n],n,e,r);if(typeof i=="boolean")return i}}function s(){this.data={}}function o(e){var t=e.indexOf(":")!==-1,n=e.split(":");return t?{type:n[0],scope:n[1]}:{type:e,scope:""}}function u(e){if(e!=="*"&&e.search(/^[a-z0-9\-\_]+:(\*|[a-z0-9\-\_]+\.?)+$/i)===-1)throw new TypeError('[scopedEvent] "'+e+'" is an invalid binding');return!0}function a(){this.model=new s}var e=/[\.:]?\*/,t=/([\.\]\[\-\}\{\?\+\*])/g;return s.prototype={each:function(e,t){return i(this.data[e],t)},add:function(e,t){var n=this,i=n.data;n.contains(e,t)||(r(i,e)||(i[e]=[]),i[e].push(t))},remove:function(e,t){var n=this,i=n.data;r(i,e)&&(i[e].length===1?delete i[e]:n.each(e,function(e,n,r,i){if(e===t)return r.splice(n,1),!1}))},get:function(e){var t=this,r,i=t.data,s=[];for(r in i)if(r===e||r.indexOf("*")!==-1&&n(r,e))s=s.concat(i[r]);return s.length>0?s:null},contains:function(e,t){return r(this.data,e)&&(this.each(e,function(e){if(e===t)return!0})||!1)}},a.prototype={bind:function(e,t,n){u(e)&&this.model.add(e,n?function(e){t.apply(n,[e])}:t)},unbind:function(e,t){u(e)&&i(this.model.get(e),function(e,n,r){if(t===e)return r.slice(n,1),!0})},trigger:function(e,t){u(e)&&i(this.model.get(e),function(n){n(t||{},o(e))})}},function(){return new a}}();
